**II. Administración y Herramientas Avanzadas: Copias de Seguridad y Restauración**

La cuarta sesión del curso se enfocó en la administración y las **herramientas avanzadas de PostgreSQL**, poniendo especial énfasis en las **copias de seguridad (backups) y la restauración**.

**A. Copias de Seguridad (Backups)**

**1. Tipos de Métodos de Backup**
Existen normalmente dos métodos para realizar las copias de seguridad dentro de PostgreSQL. Estos dos métodos principales son `PG Dump` y `PG Base Backup`.

**2. PG Dump: Genera un script de la base de datos, incluyendo registros**
El método `PG Dump` es la forma más común de sacar respaldos a nivel de todas las bases de datos. Al utilizarse, esta herramienta genera **prácticamente un *script*** que contiene toda la estructura de la base de datos. Dicho *script* incluye todas las tablas que posee la base de datos, **junto con sus registros**.

**3. PG Base Backup: Genera un archivo `.backup`**
El segundo método es el `PG Base Backup`. Este, a diferencia del anterior, genera un archivo que termina con la extensión **`.backup`**.

**4. Comparación y Uso Recomendado**

| Característica | PG Dump | PG Base Backup |
| :--- | :--- | :--- |
| **Nivel de Respaldo** | Base de datos individual. | Todo el *cluster*. |
| **Portabilidad** | **Alta portabilidad**. | Limitada, **solo entre versiones iguales**. |
| **Uso Recomendado** | Ideal para realizar **migraciones** o **respaldos ligeros**. | Recomendado para **Disaster Recovery** (recuperación ante desastres) o para sistemas de *standby*. |

**B. Restauración de Bases de Datos**

**1. Herramientas de Restauración: PSQL y PG Restore (para archivos PG Dump)**
La restauración de bases de datos se puede realizar utilizando el mismo `PSQL` o mediante la herramienta **`PG Restore`**. `PG Restore` es la herramienta de PostgreSQL utilizada para este fin.

**2. Restauración de PG Base Backup: Copiar y arrancar el motor (PE)**
Si el respaldo fue tomado mediante `PG Base Backup` (respaldo de todo el *cluster*), la restauración se realiza **copiando los archivos y arrancando (reiniciando) el motor** de PostgreSQL.

**3. Tipos de Datos de Respaldo: Archivos que terminan en `.SQL` (script) o `.PG Dump FC`, y físico (PG Base Backup)**
Para poder restaurar una base de datos, es necesario contar con el tipo de datos de respaldo. Los tipos de datos de respaldo son:
*   Archivos que terminan en **`.SQL`** (el *script*).
*   Archivos conocidos como **`PG Dump`** que terminan en **`.PG Dump FC`**.
*   El respaldo **físico** (`PG Base Backup`).

**4. Métodos de Ejecución: PG Restore o PG Admin para `.backup`, CMD para el físico**
La ejecución de la restauración varía según el tipo de respaldo:
*   Los respaldos generados como *script* (`.SQL` o `.PG Dump FC`) se pueden restaurar mediante **`PG Restore`** o utilizando la interfaz del **PG Admin**.
*   En la práctica, se demostró que para ejecutar `PG Dump` y crear el archivo `.backup` (o para restaurarlo) es necesario configurar la variable PATH y **utilizar la línea de comandos (CMD)**.
*   Para el respaldo físico (`PG Base Backup`), el proceso implica **solamente copiar los archivos y reiniciar el servidor**.

> **Analogía:** Se puede pensar en `PG Dump` como si estuvieras sacando una receta detallada (el script SQL) de tu plato favorito (la base de datos); es fácil de mover y recrear en cualquier cocina (servidor) compatible. En cambio, `PG Base Backup` es como si tomaras una foto instantánea de todo el refrigerador y la cocina completa (*cluster*); es más pesado, menos flexible, pero te permite recuperar el estado exacto de toda la instalación si ocurre un desastre.